server {
  listen 80;
  server_name _;

  # Serve files from the container path where your built app is copied
  root /usr/share/nginx/html;
  index index.html;

  # Load MIME types once so .js gets application/javascript, etc.
  include /etc/nginx/mime.types;
  default_type application/octet-stream;
  etag on;

  # Static hashed assets from Vite live under /assets/
  # Never rewrite these to index.html â€” if missing, return 404 to expose bad references
  location /assets/ {
    try_files $uri =404;
    access_log off;
    add_header Cache-Control "public, max-age=31536000, immutable" always;
  }

  # Optional: serve favicon and icons without SPA rewrite
  location = /favicon.ico { try_files $uri =404; access_log off; }
  location ~* /icons/ { try_files $uri =404; access_log off; }

  # SPA fallback for application routes (but not for assets)
  location / {
    try_files $uri $uri/ /index.html;
  }

  # Avoid caching index.html so clients always get the latest asset URLs
  location = /index.html {
    add_header Cache-Control "no-cache, no-store, must-revalidate" always;
  }
}
